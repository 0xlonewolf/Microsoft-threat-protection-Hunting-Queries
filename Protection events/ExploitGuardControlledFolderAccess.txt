
// Total Controlled Folder Access events
MiscEvents
 | where ActionType  startswith "ControlledFolderAccess" 
 | summarize NumberOfEvents=count() by ActionType
 | sort by NumberOfEvents desc

 // Controlled Folder Access events across devices
MiscEvents
 | where ActionType startswith "ControlledFolderAccess" 
 | summarize AsrDetections=count() by ComputerName
 | order by AsrDetections desc

// Exploit Guard Controlled Folder Access details
MiscEvents 
| where ActionType contains "ControlledFolderAccess"
| extend JsonOut = parse_json(AdditionalFields)
| sort by EventTime desc 
| project EventTime, ComputerName, InitiatingProcessAccountName, ActionType,  
         FileName, FolderPath, RemoteUrl, ProcessCommandLine, InitiatingProcessCommandLine,
         JsonOut.IsAudit,JsonOut.Uri,JsonOut.RuleId,JsonOut.ActivityId

